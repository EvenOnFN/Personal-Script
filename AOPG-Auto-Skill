local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local player = Players.LocalPlayer

player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

local Window = Rayfield:CreateWindow({
   Name = "Fate Hub | A One Piece Game",
   LoadingTitle = "Fate Hub Loading...",
   LoadingSubtitle = "by Fate",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "FateHub",
      FileName = "Config"
   },
   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },
   KeySystem = false,
   KeySettings = {
      Title = "Fate Hub",
      Subtitle = "Key System",
      Note = "No Key Required",
      FileName = "Key",
      SaveKey = false,
      GrabKeyFromSite = false,
      Key = {""}
   }
})

local AutoSkillsTab = Window:CreateTab("‚öîÔ∏è Auto Skills", 4483362458)
local M1Tab = Window:CreateTab("üëä Auto M1", 4483362458)
local TPFarmTab = Window:CreateTab("üåÄ TP Farm", 4483362458)
local ShopsTab = Window:CreateTab("üõí Shops", 4483362458)
local DragonTab = Window:CreateTab("üêâ Fire Dragon", 4483362458)

local autoQEnabled = false
local autoEEnabled = false
local autoFEnabled = false
local autoGEnabled = false
local autoREnabled = false
local autoM1Enabled = false
local qConnection, eConnection, fConnection, gConnection, rConnection, m1Connection = nil, nil, nil, nil, nil, nil
local lastQAttackTime = 0
local lastEAttackTime = 0
local lastFAttackTime = 0
local lastGAttackTime = 0
local lastRAttackTime = 0
local attackDelay = 0.1
local fruitAttackDelay = 1

local autoTPQEnabled = false
local tpqConnection = nil
local lastTPQAttackTime = 0
local tpHeight = 5

local autoSmartGachaEnabled = false
local autoSmartGemCapEnabled = false
local smartGachaConnection, smartGemCapConnection = nil, nil
local GachaToggle = nil
local GemCapToggle = nil

local autoDragonSummonEnabled = false
local autoDragonQEnabled = false
local autoDragonEEnabled = false
local dragonSummonConnection, dragonQConnection, dragonEConnection = nil, nil, nil
local lastDragonSummonTime = 0
local lastDragonQTime = 0
local lastDragonETime = 0
local dragonSummonDelay = 15
local DragonToggle = nil

local function getPresentCurrency()
    local currency = 0
    pcall(function()
        local stats = player:FindFirstChild("Stats")
        if stats and stats:FindFirstChild("Present") then
            currency = stats.Present.Value
        end
    end)
    return currency
end

local function getPoneglyphCurrency()
    local currency = 0
    pcall(function()
        local stats = player:FindFirstChild("Stats")
        if stats and stats:FindFirstChild("Poneglyphs") then
            currency = stats.Poneglyphs.Value
        end
    end)
    return currency
end

local function hasFireDragonKey()
    local hasKey = false
    pcall(function()
        local backpack = player:FindFirstChild("Backpack")
        if backpack and backpack:FindFirstChild("Fire Dragon Key") then
            hasKey = true
            return
        end
        
        local character = player.Character
        if character and character:FindFirstChild("Fire Dragon Key") then
            hasKey = true
        end
    end)
    return hasKey
end

local function closeDragonGUI()
    pcall(function()
        local gui = player:FindFirstChild("PlayerGui")
        if gui then
            local dragonSummoner = gui:FindFirstChild("Dragon Summoner")
            if dragonSummoner then
                local frame = dragonSummoner:FindFirstChild("Frame")
                if frame then
                    local byeButton = frame:FindFirstChild("Bye")
                    if byeButton and byeButton:IsA("TextButton") then
                        for _, connection in pairs(getconnections(byeButton.MouseButton1Click)) do
                            connection:Fire()
                        end
                    end
                end
                wait(0.1)
                dragonSummoner:Destroy()
            end
        end
    end)
end

local function hasNpcMarker(model)
    for _, child in pairs(model:GetDescendants()) do
        if child:IsA("BillboardGui") and child.Name == "NpcMarker" then
            return true
        end
    end
    return false
end

local function isRaidMob(model)
    if not model:IsA("Model") then return false end
    if not model:FindFirstChild("Humanoid") then return false end
    if not model:FindFirstChild("HumanoidRootPart") then return false end
    if Players:GetPlayerFromCharacter(model) then return false end
    
    local humanoid = model:FindFirstChild("Humanoid")
    if humanoid.Health <= 0 then return false end
    if not hasNpcMarker(model) then return false end
    
    return true
end

local function isFireDragon(model)
    if not model:IsA("Model") then return false end
    if not model:FindFirstChild("Humanoid") then return false end
    if not model:FindFirstChild("HumanoidRootPart") then return false end
    
    local humanoid = model:FindFirstChild("Humanoid")
    if humanoid.Health <= 0 then return false end
    if model.Name ~= "Awakened Beast King" then return false end
    
    return true
end

local function findFireDragon()
    if workspace:FindFirstChild("Entities") then
        for _, model in pairs(workspace.Entities:GetChildren()) do
            if isFireDragon(model) then
                return model
            end
        end
    end
    return nil
end

local function findNearestRaidMob()
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        return nil
    end
    
    local playerPos = player.Character.HumanoidRootPart.Position
    local nearestMob, nearestDistance = nil, math.huge
    
    if workspace:FindFirstChild("Entities") then
        for _, model in pairs(workspace.Entities:GetChildren()) do
            if isRaidMob(model) then
                local mobHRP = model:FindFirstChild("HumanoidRootPart")
                if mobHRP then
                    local distance = (playerPos - mobHRP.Position).Magnitude
                    if distance < nearestDistance then
                        nearestDistance = distance
                        nearestMob = model
                    end
                end
            end
        end
    end
    
    return nearestMob
end

local function getTargetPart()
    if workspace:FindFirstChild("Raid Map") then
        for _, child in pairs(workspace["Raid Map"]:GetChildren()) do
            if child:IsA("MeshPart") and child.Name:find("newcake") then return child end
        end
        for _, child in pairs(workspace["Raid Map"]:GetChildren()) do
            if child:IsA("MeshPart") then return child end
        end
        if workspace["Raid Map"]:FindFirstChild("Model") then return workspace["Raid Map"].Model end
    else
        local dawnIsland = workspace:FindFirstChild("Map") and workspace.Map:FindFirstChild("Islands") and workspace.Map.Islands:FindFirstChild("Dawn Island")
        if dawnIsland and dawnIsland:FindFirstChild("Model") then
            local model = dawnIsland.Model:FindFirstChild("Dawn Island")
            if model and model:FindFirstChild("Model") then
                local meshPart = model.Model:FindFirstChild("Meshes/daniland.2")
                if meshPart then return meshPart end
            end
        end
    end
    return workspace
end

local function getSkillArgs(styleType, skill)
    return {
        styleType,
        skill,
        player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character.HumanoidRootPart.CFrame or CFrame.new(0, 0, 0),
        getTargetPart(),
        5
    }
end

local function teleportToPosition(targetPosition)
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        player.Character.HumanoidRootPart.CFrame = CFrame.new(targetPosition)
    end
end

local function performM1()
    pcall(function()
        ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Sword Style", "MouseButton1")))
    end)
end

local function smartBuyGacha()
    pcall(function()
        local presents = getPresentCurrency()
        local version = 1
        
        if presents >= 1000 then
            version = 3
        elseif presents >= 500 then
            version = 2
        elseif presents >= 100 then
            version = 1
        else
            autoSmartGachaEnabled = false
            if smartGachaConnection then
                smartGachaConnection:Disconnect()
                smartGachaConnection = nil
            end
            if GachaToggle then
                GachaToggle:Set(false)
            end
            Rayfield:Notify({
                Title = "Christmas Gacha",
                Content = "Disabled - Not enough presents!",
                Duration = 5,
                Image = 4483362458,
                Actions = {}
            })
            return
        end
        
        player:WaitForChild("PlayerGui"):WaitForChild("NewPresentShop"):WaitForChild("buy"):FireServer(version)
    end)
end

local function smartIncreaseGemCap()
    pcall(function()
        local poneglyphs = getPoneglyphCurrency()
        
        if poneglyphs <= 1 then
            autoSmartGemCapEnabled = false
            if smartGemCapConnection then
                smartGemCapConnection:Disconnect()
                smartGemCapConnection = nil
            end
            if GemCapToggle then
                GemCapToggle:Set(false)
            end
            Rayfield:Notify({
                Title = "Gem Cap Increase",
                Content = "Disabled - Down to last poneglyph!",
                Duration = 5,
                Image = 4483362458,
                Actions = {}
            })
            return
        end
        
        local amount = 1
        if poneglyphs >= 10 then
            amount = 10
        elseif poneglyphs >= 5 then
            amount = 5
        else
            amount = 1
        end
        
        player:WaitForChild("PlayerGui"):WaitForChild("NewPoneglyphMerchant"):WaitForChild("Event"):FireServer(amount)
    end)
end

local function summonDragon()
    pcall(function()
        local currentTime = tick()
        
        if currentTime - lastDragonSummonTime < dragonSummonDelay then
            return
        end
        
        local existingDragon = findFireDragon()
        if existingDragon then
            return
        end
        
        if not hasFireDragonKey() then
            autoDragonSummonEnabled = false
            if dragonSummonConnection then
                dragonSummonConnection:Disconnect()
                dragonSummonConnection = nil
            end
            if DragonToggle then
                DragonToggle:Set(false)
            end
            Rayfield:Notify({
                Title = "Dragon Summon",
                Content = "Disabled - Out of Fire Dragon Keys!",
                Duration = 5,
                Image = 4483362458,
                Actions = {}
            })
            return
        end
        
        lastDragonSummonTime = currentTime
        
        ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("clonegui"):FireServer("Dragon Summoner")
        wait(0.3)
        
        local gui = player:WaitForChild("PlayerGui")
        local dragonSummoner = gui:FindFirstChild("Dragon Summoner")
        if dragonSummoner then
            local eventRemote = dragonSummoner:FindFirstChild("Event")
            if eventRemote then
                eventRemote:FireServer()
                wait(0.1)
                closeDragonGUI()
                wait(2)
            end
        end
    end)
end

local AutoSkillsSection = AutoSkillsTab:CreateSection("Sword Style Skills")

Rayfield:Notify({
    Title = "Fate Hub Loaded",
    Content = "Script initialized successfully! Anti-AFK is active.",
    Duration = 5,
    Image = 4483362458,
    Actions = {}
})

local QToggle = AutoSkillsTab:CreateToggle({
    Name = "Auto Q Skill (Sword)",
    CurrentValue = false,
    Flag = "SwordQ",
    Callback = function(value)
        autoQEnabled = value
        if value then
            Rayfield:Notify({
                Title = "Sword Q",
                Content = "Enabled - Attacking raid mobs!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            qConnection = RunService.Heartbeat:Connect(function()
                if not autoQEnabled then return end
                local mob = findNearestRaidMob()
                if mob and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    local currentTime = tick()
                    if currentTime - lastQAttackTime >= attackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Sword Style", "Q")))
                        end)
                        lastQAttackTime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "Sword Q",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if qConnection then qConnection:Disconnect() qConnection = nil end
        end
    end
})

local EToggle = AutoSkillsTab:CreateToggle({
    Name = "Auto E Skill (Sword)",
    CurrentValue = false,
    Flag = "SwordE",
    Callback = function(value)
        autoEEnabled = value
        if value then
            Rayfield:Notify({
                Title = "Sword E",
                Content = "Enabled - Attacking raid mobs!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            eConnection = RunService.Heartbeat:Connect(function()
                if not autoEEnabled then return end
                local mob = findNearestRaidMob()
                if mob and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    local currentTime = tick()
                    if currentTime - lastEAttackTime >= attackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Sword Style", "E")))
                        end)
                        lastEAttackTime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "Sword E",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if eConnection then eConnection:Disconnect() eConnection = nil end
        end
    end
})

AutoSkillsTab:CreateParagraph({Title = "‚ÑπÔ∏è Sword Info", Content = "Automatically targets raid mobs with NpcMarker. Does not teleport to mobs."})

local FruitSkillsSection = AutoSkillsTab:CreateSection("Devil Fruit Skills")

local FToggle = AutoSkillsTab:CreateToggle({
    Name = "Auto F Skill (Devil Fruit)",
    CurrentValue = false,
    Flag = "FruitF",
    Callback = function(value)
        autoFEnabled = value
        if value then
            Rayfield:Notify({
                Title = "Devil Fruit F",
                Content = "Enabled - Attacking raid mobs!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            fConnection = RunService.Heartbeat:Connect(function()
                if not autoFEnabled then return end
                local mob = findNearestRaidMob()
                if mob and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    local currentTime = tick()
                    if currentTime - lastFAttackTime >= fruitAttackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Devil Fruit", "F")))
                        end)
                        lastFAttackTime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "Devil Fruit F",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if fConnection then fConnection:Disconnect() fConnection = nil end
        end
    end
})

local GToggle = AutoSkillsTab:CreateToggle({
    Name = "Auto G Skill (Devil Fruit)",
    CurrentValue = false,
    Flag = "FruitG",
    Callback = function(value)
        autoGEnabled = value
        if value then
            Rayfield:Notify({
                Title = "Devil Fruit G",
                Content = "Enabled - Attacking raid mobs!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            gConnection = RunService.Heartbeat:Connect(function()
                if not autoGEnabled then return end
                local mob = findNearestRaidMob()
                if mob and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    local currentTime = tick()
                    if currentTime - lastGAttackTime >= fruitAttackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Devil Fruit", "G")))
                        end)
                        lastGAttackTime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "Devil Fruit G",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if gConnection then gConnection:Disconnect() gConnection = nil end
        end
    end
})

local RToggle = AutoSkillsTab:CreateToggle({
    Name = "Auto R Skill (Devil Fruit)",
    CurrentValue = false,
    Flag = "FruitR",
    Callback = function(value)
        autoREnabled = value
        if value then
            Rayfield:Notify({
                Title = "Devil Fruit R",
                Content = "Enabled - Attacking raid mobs!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            rConnection = RunService.Heartbeat:Connect(function()
                if not autoREnabled then return end
                local mob = findNearestRaidMob()
                if mob and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    local currentTime = tick()
                    if currentTime - lastRAttackTime >= fruitAttackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Devil Fruit", "R")))
                        end)
                        lastRAttackTime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "Devil Fruit R",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if rConnection then rConnection:Disconnect() rConnection = nil end
        end
    end
})

AutoSkillsTab:CreateParagraph({Title = "‚ÑπÔ∏è Devil Fruit Info", Content = "Automatically targets raid mobs with NpcMarker. Uses devil fruit abilities with 1 second delay. Anti-AFK is always active."})

local M1Section = M1Tab:CreateSection("Sword Style M1 Automation")

local M1Toggle = M1Tab:CreateToggle({
    Name = "Auto M1 (Sword Style)",
    CurrentValue = false,
    Flag = "AutoM1",
    Callback = function(value)
        autoM1Enabled = value
        if value then
            Rayfield:Notify({
                Title = "Auto M1",
                Content = "Enabled - Spamming M1 attacks!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            m1Connection = RunService.Heartbeat:Connect(function()
                if not autoM1Enabled then return end
                performM1()
            end)
        else
            Rayfield:Notify({
                Title = "Auto M1",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if m1Connection then m1Connection:Disconnect() m1Connection = nil end
        end
    end
})

M1Tab:CreateParagraph({Title = "‚ÑπÔ∏è Info", Content = "Continuously spams Sword Style M1 attacks. Works at all times when enabled."})

local TPFarmSection = TPFarmTab:CreateSection("Teleport Farm Configuration")

local TPQToggle = TPFarmTab:CreateToggle({
    Name = "Auto TP + Q Farm",
    CurrentValue = false,
    Flag = "AutoTPQ",
    Callback = function(value)
        autoTPQEnabled = value
        if value then
            Rayfield:Notify({
                Title = "TP + Q Farm",
                Content = "Enabled - Teleporting and attacking!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            tpqConnection = RunService.Heartbeat:Connect(function()
                if not autoTPQEnabled then return end
                local mob = findNearestRaidMob()
                if mob and mob:FindFirstChild("Humanoid") and mob:FindFirstChild("HumanoidRootPart") and mob.Humanoid.Health > 0 then
                    teleportToPosition(mob.HumanoidRootPart.Position + Vector3.new(0, tpHeight, 0))
                    local currentTime = tick()
                    if currentTime - lastTPQAttackTime >= attackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Sword Style", "Q")))
                        end)
                        lastTPQAttackTime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "TP + Q Farm",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if tpqConnection then tpqConnection:Disconnect() tpqConnection = nil end
        end
    end
})

TPFarmTab:CreateParagraph({Title = "‚ÑπÔ∏è Info", Content = "Teleports to nearest raid mob and uses Q skill automatically. Efficient for farming."})

local ShopsSection = ShopsTab:CreateSection("Smart Shop Automation")

GachaToggle = ShopsTab:CreateToggle({
    Name = "Smart Christmas Gacha",
    CurrentValue = false,
    Flag = "SmartGacha",
    Callback = function(value)
        autoSmartGachaEnabled = value
        if value then
            local presents = getPresentCurrency()
            Rayfield:Notify({
                Title = "Smart Gacha",
                Content = "Enabled - " .. presents .. " presents available",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            smartGachaConnection = RunService.Heartbeat:Connect(function()
                if not autoSmartGachaEnabled then return end
                smartBuyGacha()
            end)
        else
            Rayfield:Notify({
                Title = "Smart Gacha",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if smartGachaConnection then smartGachaConnection:Disconnect() smartGachaConnection = nil end
        end
    end
})

GemCapToggle = ShopsTab:CreateToggle({
    Name = "Smart Gem Cap Increase",
    CurrentValue = false,
    Flag = "SmartGemCap",
    Callback = function(value)
        autoSmartGemCapEnabled = value
        if value then
            local poneglyphs = getPoneglyphCurrency()
            Rayfield:Notify({
                Title = "Smart Gem Cap",
                Content = "Enabled - " .. poneglyphs .. " poneglyphs available",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            smartGemCapConnection = RunService.Heartbeat:Connect(function()
                if not autoSmartGemCapEnabled then return end
                smartIncreaseGemCap()
            end)
        else
            Rayfield:Notify({
                Title = "Smart Gem Cap",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if smartGemCapConnection then smartGemCapConnection:Disconnect() smartGemCapConnection = nil end
        end
    end
})

ShopsTab:CreateParagraph({Title = "‚ÑπÔ∏è Gacha Info", Content = "Auto-detects Present currency and buys the best option (100/500/1000). Stops when currency runs out."})
ShopsTab:CreateParagraph({Title = "‚ÑπÔ∏è Gem Cap Info", Content = "Auto-detects Poneglyphs and increases gem cap (1/5/10). Stops at 1 poneglyph to prevent bugs."})

local DragonSection = DragonTab:CreateSection("Fire Dragon Automation")

DragonToggle = DragonTab:CreateToggle({
    Name = "Auto Summon Dragon",
    CurrentValue = false,
    Flag = "AutoDragonSummon",
    Callback = function(value)
        autoDragonSummonEnabled = value
        if value then
            Rayfield:Notify({
                Title = "Dragon Summon",
                Content = "Enabled - Will summon when not spawned",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            dragonSummonConnection = RunService.Heartbeat:Connect(function()
                if not autoDragonSummonEnabled then return end
                summonDragon()
            end)
        else
            Rayfield:Notify({
                Title = "Dragon Summon",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if dragonSummonConnection then dragonSummonConnection:Disconnect() dragonSummonConnection = nil end
        end
    end
})

local DragonQToggle = DragonTab:CreateToggle({
    Name = "Dragon Killer Q",
    CurrentValue = false,
    Flag = "DragonQ",
    Callback = function(value)
        autoDragonQEnabled = value
        if value then
            Rayfield:Notify({
                Title = "Dragon Killer Q",
                Content = "Enabled - Attacking Awakened Beast King!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            dragonQConnection = RunService.Heartbeat:Connect(function()
                if not autoDragonQEnabled then return end
                local dragon = findFireDragon()
                if dragon and dragon:FindFirstChild("Humanoid") and dragon.Humanoid.Health > 0 then
                    local currentTime = tick()
                    if currentTime - lastDragonQTime >= attackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Sword Style", "Q")))
                        end)
                        lastDragonQTime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "Dragon Killer Q",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if dragonQConnection then dragonQConnection:Disconnect() dragonQConnection = nil end
        end
    end
})

local DragonEToggle = DragonTab:CreateToggle({
    Name = "Dragon Killer E",
    CurrentValue = false,
    Flag = "DragonE",
    Callback = function(value)
        autoDragonEEnabled = value
        if value then
            Rayfield:Notify({
                Title = "Dragon Killer E",
                Content = "Enabled - Attacking Awakened Beast King!",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            dragonEConnection = RunService.Heartbeat:Connect(function()
                if not autoDragonEEnabled then return end
                local dragon = findFireDragon()
                if dragon and dragon:FindFirstChild("Humanoid") and dragon.Humanoid.Health > 0 then
                    local currentTime = tick()
                    if currentTime - lastDragonETime >= attackDelay then
                        pcall(function()
                            ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("requestAbility"):FireServer(unpack(getSkillArgs("Sword Style", "E")))
                        end)
                        lastDragonETime = currentTime
                    end
                end
            end)
        else
            Rayfield:Notify({
                Title = "Dragon Killer E",
                Content = "Disabled",
                Duration = 3,
                Image = 4483362458,
                Actions = {}
            })
            if dragonEConnection then dragonEConnection:Disconnect() dragonEConnection = nil end
        end
    end
})

DragonTab:CreateParagraph({Title = "‚ÑπÔ∏è Info", Content = "Only summons Fire Dragon if not already spawned. Uses Fire Dragon Keys from your backpack. 15 second cooldown between summons to prevent key waste and handle lag. Target: Awakened Beast King (5B HP)"})

print("‚úÖ Fate Hub Loaded Successfully!")
print("üì± UI: Rayfield")
print("üë§ Made by: Fate")
print("üîß Features: Auto Skills (Sword + Devil Fruit) | TP Farm | Auto M1 | Smart Shops | Fire Dragon")
